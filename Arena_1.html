<!doctype html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <title>Arena_Main</title>
<script src="https://kit.fontawesome.com/d2d2ecd819.js" crossorigin="anonymous"></script>
<script src="js/jquery.min.js"></script>
	<script>
	localStorage.UsEr_Name_MemEArIna_UsEr_ApS2_image_selected = "none";
	</script>
  </head>
  <body style="background-color: #5F4DEE">
	<nav class="navbar navbar-dark fixed-bottom" style="background-color: #7464f0 ;box-shadow: rgba(0, 0, 0, 0.25) 0px 54px 55px, rgba(0, 0, 0, 0.12) 0px -12px 30px, rgba(0, 0, 0, 0.12) 0px 4px 6px, rgba(0, 0, 0, 0.17) 0px 12px 13px, rgba(0, 0, 0, 0.09) 0px -3px 5px;">

     <div class="container-fluid d-inline-block d-flex">
       <div class="collapse" id="c">
         <div class="card card-body">
           <div class="container">
             <hr>
               <div class="progress" style="height: 20px;">
                 <div class="progress-bar  progress-bar-striped progress-bar-animated" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width: 50%" id="g1bar"><b>Old Monks</b></div>
               </div><br>
               <div class="progress" style="height: 20px;">
                 <div class="progress-bar bg-danger progress-bar-striped progress-bar-animated" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width: 50%" id="g2bar"><b>The FKRs</b></div>
               </div>
            <p style="color:white"> a a a a a a a a a a a a a a a a a a a a a a a a a a a a a a a</p>
            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
  <button class="btn btn-outline-secondary me-md-2" type="button" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="c" href="#c">Close</button>
</div>
         </div>
         </div>
        <br>
      </div>
	      <button class="btn btn-light" id="g1" style="width: 46%;border-radius: 25px;margin-right:5px;margin-top:4px" data-bs-toggle="collapse"role="button" aria-expanded="false" aria-controls="c"><b>Old Monks</b></button>
        <button class="btn btn-light" id="g2" style="width: 46%;border-radius: 25px;margin-top:4px" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="c" ><b>The FKRs</b></button>
    </div>
	</nav>


	<nav class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color: #7464f0 ;box-shadow: rgba(50, 50, 93, 0.25) 0px 13px 27px -5px, rgba(0, 0, 0, 0.3) 0px 8px 16px -8px; font-color:red !important">
  <div class="container-fluid">
    <a class="navbar-brand" href="#"><h1 style="color:white !important;">XI Home Page</h1></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link" href="main.html"><b>Community Chat</b></a>
        </li><hr style="color:white">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#"><b>Arena</b></a>
        </li><hr style="color:white">
      </ul>
    </div>
  </div>
</nav>
	<br>
	<br>
	<div class="container">
		<div class="mt-4 p-5 rounded border border-dark" style="background-color: #FFFAFA ;" id="main-ChatBox">
        <br>
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingOne">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Battle Arena
            </button>
          </h2>
          <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne">
            <div class="accordion-body">
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col"><center><b>Group1</b></center></th>
                    <th scope="col"><center><b>Group2</b></center></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">1</th>
                    <td><center>L</center></td>
                    <td><center>D</center></td>
                  </tr>
                  <tr>
                    <th scope="row">2</th>
                    <td><center>X</center></td>
                    <td><center>C</center></td>
                  </tr>
                  <tr>
                    <th scope="row">3</th>
                    <td><center>Y</center></td>
                    <td><center>B</center></td>
                  </tr>
                  <tr>
                    <th scope="row">4</th>
                    <td><center>Z</center></td>
                    <td><center>A</center></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <br>
        <center><h2>Start<hr style="width:50%"></h2></center>
		</div>
	</div>

  <br>
  <br>
  <br>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script type="module">
	  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
	  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics.js";
	  const firebaseConfig = {
		apiKey: "AIzaSyCLhgz6eHJz1h75UCzJBLpKXG3ej0m8Hpc",
		authDomain: "meme-arena-x.firebaseapp.com",
		databaseURL: "https://meme-arena-x-default-rtdb.asia-southeast1.firebasedatabase.app",
		projectId: "meme-arena-x",
		storageBucket: "meme-arena-x.appspot.com",
		messagingSenderId: "1065864797805",
		appId: "1:1065864797805:web:348583a22f09f1d2f5a964",
		measurementId: "G-5QW7K75VEE"
	  };
	  const app = initializeApp(firebaseConfig);
	  const analytics = getAnalytics(app);
	  import {getDatabase, ref, set, child, onValue, get}
	  from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";
	  const db = getDatabase();
  const matchname = "Arena1"
	get(ref(db, "Arenas/"+matchname+"/T")).then((snapshot) => {mainfn(snapshot.val())});
	const room = document.getElementById("main-ChatBox");
  const group1 = ["Vishwash"];
	var filemaybe = "";
	var filemaybe_type = "";

  barchnage();


  onValue(ref(db,"Arenas/"+matchname+"/g1"), (snapshot) => {barchnage()});
  onValue(ref(db,"Arenas/"+matchname+"/g2"), (snapshot) => {barchnage()});

  function barchnage(){
    get(ref(db, "Arenas/"+matchname+"/g1")).then((snapshot1) => {
      get(ref(db, "Arenas/"+matchname+"/g2")).then((snapshot2) => {
        document.getElementById("g1bar").style = ("width:"+(snapshot1.val()*100/(snapshot1.val()+snapshot2.val())).toFixed(0)+"%");
        document.getElementById("g2bar").style = ("width:"+(snapshot2.val()*100/(snapshot1.val()+snapshot2.val())).toFixed(0)+"%");
      });
    });
  }


  document.getElementById("g1").onclick = function()
  {
    var isVisible = $('#c').is( ":visible" );
    		if(!isVisible){
    			$('#c').collapse('show');
    		};
    if(localStorage.UsEr_Name_MemEArIna_UsEr_ApS2_Voted_Arena1 == null){
      get(ref(db, "Arenas/"+matchname+"/g1")).then((snapshot) => {set(ref(db,"Arenas/"+matchname+"/g1"),((snapshot.val()+1)));});
      localStorage.UsEr_Name_MemEArIna_UsEr_ApS2_Voted_Arena1 = "g1";
      const toAppend_msg = '<div class="alert alert-primary" role="alert">  You voted Old Monks </div>';
      var new_msg = document.createElement("p");
      new_msg.innerHTML = toAppend_msg
      room.appendChild(new_msg);

    }
    else if(localStorage.UsEr_Name_MemEArIna_UsEr_ApS2_Voted_Arena1 == "g2"){
      get(ref(db, "Arenas/"+matchname+"/g2")).then((snapshot) => {set(ref(db,"Arenas/"+matchname+"/g2"),((snapshot.val()-1)));});
      get(ref(db, "Arenas/"+matchname+"/g1")).then((snapshot) => {set(ref(db,"Arenas/"+matchname+"/g1"),((snapshot.val()+1)));});
      localStorage.UsEr_Name_MemEArIna_UsEr_ApS2_Voted_Arena1 = "g1";
      const toAppend_msg = '<div class="alert alert-primary" role="alert">  You voted Old Monks </div>';
      var new_msg = document.createElement("p");
      new_msg.innerHTML = toAppend_msg
      room.appendChild(new_msg);

    }
  };

  document.getElementById("g2").onclick = function()
  {
    var isVisible = $('#c').is( ":visible" );
        if(!isVisible){
          $('#c').collapse('show');
        };
    if(localStorage.UsEr_Name_MemEArIna_UsEr_ApS2_Voted_Arena1 == null){
      get(ref(db, "Arenas/"+matchname+"/g2")).then((snapshot) => {set(ref(db,"Arenas/"+matchname+"/g2"),((snapshot.val()+1)));});
      localStorage.UsEr_Name_MemEArIna_UsEr_ApS2_Voted_Arena1 = "g2";
      const toAppend_msg = '<div class="alert alert-secondary" role="alert">  You voted The FkRs </div>';
      var new_msg = document.createElement("p");
      new_msg.innerHTML = toAppend_msg
      room.appendChild(new_msg);
    }
    else if(localStorage.UsEr_Name_MemEArIna_UsEr_ApS2_Voted_Arena1 == "g1"){
      get(ref(db, "Arenas/"+matchname+"/g2")).then((snapshot) => {set(ref(db,"Arenas/"+matchname+"/g2"),((snapshot.val()+1)));});
      get(ref(db, "Arenas/"+matchname+"/g1")).then((snapshot) => {set(ref(db,"Arenas/"+matchname+"/g1"),((snapshot.val()-1)));});
      localStorage.UsEr_Name_MemEArIna_UsEr_ApS2_Voted_Arena1 = "g2";
      const toAppend_msg = '<div class="alert alert-secondary" role="alert">  You voted The FkRs </div>';
      var new_msg = document.createElement("p");
      new_msg.innerHTML = toAppend_msg
      room.appendChild(new_msg);
    }
  };

	function mainfn(no_of_msg)
	{
		for (let i = 0; i < no_of_msg; i++) {
			get(ref(db, "Arenas/"+matchname+"/"+(i+1)+"/name")).then((snapshot) => {const sub_name = snapshot.val();
				get(ref(db, "Arenas/"+matchname+"/"+(i+1)+"/message")).then((snapshot) => {const sub_msg = snapshot.val();
					if (group1.includes(sub_name)){
						const toAppend_msg = "<p style='text-align:right'>"+sub_msg+"</p><hr>";
						var new_msg = document.createElement("p");
						new_msg.innerHTML = toAppend_msg
						room.appendChild(new_msg);
					}
					else
					{
						const toAppend_msg = "<p>"+sub_msg+"</p><hr>";
						var new_msg = document.createElement("p");
						new_msg.innerHTML = toAppend_msg
						room.appendChild(new_msg);
					};
				});
			});
		}
	};
	var xtemp = 0;
	onValue(ref(db,"Arenas/"+matchname+"/T"), (snapshot) => {
			xtemp = xtemp + 1;
			if (xtemp > 1)
			{
				var newid = snapshot.val();
				get(ref(db, "Arenas/"+matchname+"/"+(newid)+"/name")).then((snapshot) => {var newsub_name = snapshot.val();
					get(ref(db, "Arenas/"+matchname+"/"+(newid)+"/message")).then((snapshot) => {var newsub_msg = snapshot.val();
						if (group1.includes(newsub_name)){
							const newtoAppend_msg = "<p style='text-align:right'>"+newsub_msg+"</p><hr>";
							var newnew_msg = document.createElement("p");
							newnew_msg.innerHTML = newtoAppend_msg
							room.appendChild(newnew_msg);
						}
						else
						{
							const newtoAppend_msg = "<p>"+newsub_msg+"</p><hr>";
							var newnew_msg = document.createElement("p");
							newnew_msg.innerHTML = newtoAppend_msg
							room.appendChild(newnew_msg);
						};
					});
				});
			}
		});
</script>
  </body>
</html>
